<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ODI Match Predictor</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #00aaff;
      --secondary-color: #0077cc;
      --background-start: #0f2027;
      --background-end: #2c5364;
      --card-bg: rgba(255, 255, 255, 0.05);
      --text-color: #e0eafc;
      --border-color: rgba(255, 255, 255, 0.2);
    }

    * {
      box-sizing: border-box;
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, var(--background-start), var(--background-end));
      color: var(--text-color);
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: fadeIn 1.5s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    header {
      width: 100%;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(0,0,0,0.2);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border-color);
    }
    
    header h1 {
        font-size: 1.8rem;
        color: #fff;
        margin: 0;
        font-weight: 600;
    }

    header a {
        color: #fff;
        text-decoration: none;
        font-weight: 500;
        padding: 0.5rem 1rem;
        border: 1px solid transparent;
        border-radius: 8px;
        transition: all 0.3s ease;
    }

    header a:hover {
        background: var(--primary-color);
        border-color: var(--primary-color);
        transform: translateY(-2px);
    }

    .main-title {
      margin-top: 40px;
      font-size: clamp(2rem, 5vw, 3.5rem);
      color: #fff;
      font-weight: 700;
      letter-spacing: 1px;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
      text-align: center;
    }

    .team-inputs {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 30px;
      gap: 20px;
      padding: 0 20px;
      width: 100%;
      max-width: 800px;
    }

    select {
      flex: 1 1 300px;
      padding: 14px 20px;
      font-size: 1rem;
      border: 1px solid var(--border-color);
      border-radius: 12px;
      background: var(--card-bg);
      color: var(--text-color);
      transition: all 0.3s ease;
      appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23e0eafc' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 1rem center;
      background-size: 1em;
    }
    
    select option {
        background: #2c5364;
        color: #fff;
    }

    select:focus {
      border-color: var(--primary-color);
      outline: none;
      box-shadow: 0 0 15px rgba(0, 170, 255, 0.5);
    }

    .flags-display {
      margin-top: 30px;
      display: flex;
      gap: 20px;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      min-height: 100px;
    }

    .flags-display .team-container {
        text-align: center;
    }

    .flags-display img {
      width: 100px;
      height: 65px;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
      border: 2px solid var(--border-color);
    }
    
    .flags-display .vs-text {
        font-size: 2rem;
        font-weight: 700;
        color: #fff;
    }

    .flags-display .team-name {
      text-align: center;
      font-weight: 600;
      color: var(--text-color);
      margin-top: 10px;
      font-size: 1.1rem;
    }

    .content {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 40px;
      gap: 30px;
      padding: 20px;
      width: 100%;
      max-width: 1200px;
    }

    .container {
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      flex: 1 1 400px;
      padding: 35px 30px;
      border-radius: 25px;
      border: 1px solid var(--border-color);
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
      text-align: center;
      min-width: 350px;
      transition: all 0.3s ease;
    }

    .container:hover {
      transform: translateY(-10px);
      box-shadow: 0 14px 40px rgba(0, 0, 0, 0.4);
      border-color: var(--primary-color);
    }

    .container h2 {
      margin-bottom: 25px;
      font-size: 1.8rem;
      color: #fff;
      font-weight: 600;
    }

    .input-group {
        position: relative;
        margin-bottom: 20px;
    }

    .input-group i {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #aaa;
    }

    label {
      display: block;
      text-align: left;
      margin: 15px 0 8px;
      font-weight: 500;
      color: var(--text-color);
      font-size: 0.95rem;
    }

    input[type="number"] {
      width: 100%;
      padding: 14px 14px 14px 40px;
      border: 1px solid var(--border-color);
      border-radius: 12px;
      background: transparent;
      font-size: 1rem;
      color: var(--text-color);
      transition: all 0.3s ease;
    }

    input[type="number"]:focus {
      border-color: var(--primary-color);
      outline: none;
      background: rgba(0, 170, 255, 0.1);
    }

    button {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 15px;
      width: 100%;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      margin-top: 10px;
      transition: all 0.3s ease;
    }

    button:hover {
      background: var(--secondary-color);
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 170, 255, 0.4);
    }

    button:active {
      transform: scale(0.97);
    }

    .prediction-output {
      margin-top: 20px;
      font-size: 1.1rem;
      color: var(--text-color);
      font-weight: 500;
      word-break: break-word;
      min-height: 100px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      line-height: 1.6;
    }
    
    /* --- New Prediction Output Styles --- */
    .prediction-output .winner-line {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 12px;
        gap: 12px;
    }

    .prediction-output .winner-line img {
        width: 45px;
        height: 30px;
        object-fit: cover;
        border-radius: 6px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.4);
    }

    .prediction-output .winner-name {
        font-size: 1.75rem;
        font-weight: 700;
        color: #fff;
    }

    .prediction-output .probability-line {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 15px;
        font-size: 1.05rem;
        width: 100%;
    }

    .prediction-output .probability-line .team-prob {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .prediction-output .probability-line img {
        width: 24px;
        height: 16px;
        object-fit: cover;
        border-radius: 4px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    .prediction-output .prob-separator {
        color: var(--border-color);
        font-weight: 300;
    }

    .prediction-output .score-line {
        font-size: 2.5rem;
        color: var(--primary-color);
        font-weight: 700;
        margin-top: 8px;
    }

    .prediction-output .score-label {
        font-size: 1.1rem;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    .prediction-output .score-label img {
        width: 30px;
        height: 20px;
        object-fit: cover;
        border-radius: 4px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }
    /* --- End New Styles --- */

    footer {
      margin-top: 50px;
      padding: 20px;
      font-size: 0.9rem;
      color: #aaa;
      text-align: center;
    }
    
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.7);
        backdrop-filter: blur(5px);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    .modal-overlay.visible {
        display: flex;
        opacity: 1;
    }
    .modal-content {
        background: linear-gradient(135deg, #2c5364, #203a43);
        padding: 30px;
        border-radius: 20px;
        border: 1px solid var(--border-color);
        box-shadow: 0 8px 32px rgba(0,0,0,0.5);
        text-align: center;
        width: 90%;
        max-width: 400px;
        transform: scale(0.9);
        transition: transform 0.3s ease;
    }
    .modal-overlay.visible .modal-content {
        transform: scale(1);
    }
    .modal-content p {
        font-size: 1.2rem;
        color: #fff;
        margin: 0 0 20px 0;
    }
    .modal-content button {
        width: auto;
        padding: 10px 30px;
    }
  </style>
</head>
<body>

<header>
    <h1>ODI Predictor</h1>
    <a href="https://fitness-coach-pro.onrender.com/" target="_blank">AI Fitness Coach</a>
</header>

<h1 class="main-title">üèè ODI Match Predictor</h1>

<div class="team-inputs">
  <select id="team_batting" onchange="getTeams()">
    <option value="">Select Batting Team</option>
  </select>
  <select id="team_bowling" onchange="getTeams()">
    <option value="">Select Bowling Team</option>
  </select>
</div>

<div class="flags-display" id="flags_display"></div>

<div class="content">
  <div class="container">
    <h2>First Innings Prediction</h2>
    <label for="curr_runs">Current Score</label>
    <div class="input-group">
      <i class="fas fa-cricket-bat"></i>
      <input type="number" id="curr_runs" placeholder="e.g., 120">
    </div>
    <label for="curr_wickets">Wickets Lost</label>
    <div class="input-group">
        <i class="fas fa-crosshairs"></i>
        <input type="number" id="curr_wickets" placeholder="e.g., 3">
    </div>
    <label for="overs">Overs Bowled</label>
    <div class="input-group">
        <i class="fas fa-stopwatch"></i>
        <input type="number" step="0.1" id="overs" placeholder="e.g., 25.4">
    </div>
    <button onclick="predictFirstInnings()">Predict Final Score</button>
    <div class="prediction-output" id="prediction_result"></div>
  </div>

  <div class="container">
    <h2>Second Innings Prediction</h2>
    <label for="target">Target Score</label>
    <div class="input-group">
        <i class="fas fa-cricket-bat"></i>
        <input type="number" id="curr_runs2" placeholder="e.g., 150">
    </div>
    <label for="curr_wickets2">Wickets Lost</label>
    <div class="input-group">
        <i class="fas fa-crosshairs"></i>
        <input type="number" id="curr_wickets2" placeholder="e.g., 4">
    </div>
    <label for="overs2">Overs Bowled</label>
    <div class="input-group">
        <i class="fas fa-stopwatch"></i>
        <input type="number" step="0.1" id="overs2" placeholder="e.g., 30.1">
    </div>
    <button onclick="predictSecondInnings()">Predict Win Probability</button>
    <div class="prediction-output" id="chase_result"></div>
  </div>
</div>

<div class="modal-overlay" id="custom_modal">
    <div class="modal-content">
        <p id="modal_message"></p>
        <button onclick="closeModal()">OK</button>
    </div>
</div>

<footer>¬© 2025 ODI Predictor. All rights reserved.</footer>

<script>
  const flags = {
    "Afghanistan": "https://flagcdn.com/w320/af.png",
    "Australia": "https://flagcdn.com/w320/au.png",
    "Bangladesh": "https://flagcdn.com/w320/bd.png",
    "England": "https://flagcdn.com/w320/gb.png",
    "India": "https://flagcdn.com/w320/in.png",
    "Ireland": "https://flagcdn.com/w320/ie.png",
    "Nepal": "https://flagcdn.com/w320/np.png",
    "Netherlands": "https://flagcdn.com/w320/nl.png",
    "New Zealand": "https://flagcdn.com/w320/nz.png",
    "Pakistan": "https://flagcdn.com/w320/pk.png",
    "South Africa": "https://flagcdn.com/w320/za.png",
    "Sri Lanka": "https://flagcdn.com/w320/lk.png",
    "West Indies": "https://flagcdn.com/w320/ag.png", // Using Antigua and Barbuda flag for West Indies
    "Zimbabwe": "https://flagcdn.com/w320/zw.png"
  };

  let teamBatting = "";
  let teamBowling = "";

  window.onload = function () {
    const battingSelect = document.getElementById("team_batting");
    const bowlingSelect = document.getElementById("team_bowling");

    const sortedTeams = Object.keys(flags).sort();
    sortedTeams.forEach(team => {
      const option = document.createElement("option");
      option.value = team;
      option.text = team;
      battingSelect.appendChild(option.cloneNode(true));
      bowlingSelect.appendChild(option);
    });
  };

  function showModal(message) {
      document.getElementById('modal_message').textContent = message;
      document.getElementById('custom_modal').classList.add('visible');
  }

  function closeModal() {
      document.getElementById('custom_modal').classList.remove('visible');
  }

  function getTeams() {
    teamBatting = document.getElementById("team_batting").value;
    teamBowling = document.getElementById("team_bowling").value;

    if (teamBatting && teamBowling) {
      if (teamBatting === teamBowling) {
        showModal("‚ùå Batting and Bowling teams cannot be the same!");
        document.getElementById("team_bowling").value = "";
        teamBowling = "";
        document.getElementById("flags_display").innerHTML = "";
        return;
      }
      showFlags(teamBatting, teamBowling);
    } else {
        document.getElementById("flags_display").innerHTML = "";
    }
  }

  function showFlags(team1, team2) {
    document.getElementById("flags_display").innerHTML = `
      <div class="team-container">
        <img src="${flags[team1]}" alt="${team1}">
        <div class="team-name">${team1}</div>
      </div>
      <div class="vs-text">VS</div>
      <div class="team-container">
        <img src="${flags[team2]}" alt="${team2}">
        <div class="team-name">${team2}</div>
      </div>
    `;
  }

   async function predictFirstInnings() {
    if (!teamBatting || !teamBowling) {
      showModal("Please select both batting and bowling teams!");
      return;
    }
    const curr_runs = document.getElementById("curr_runs").value;
    const curr_wickets = document.getElementById("curr_wickets").value;
    const overs = document.getElementById("overs").value;

    if (!curr_runs || !curr_wickets || !overs) {
        showModal("Please fill in all fields for the first innings!");
        return;
    }

    const resultElement = document.getElementById("prediction_result");
    resultElement.innerHTML = `<i class="fas fa-spinner fa-spin fa-2x"></i>`;
     
    try {
      const response = await fetch('/predict_first_innings', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ curr_runs, curr_wickets, overs })
      });
      const data = await response.json();
      resultElement.innerHTML = `
        <div class="score-label">
          Predicted Score for <img src="${flags[teamBatting]}" alt="${teamBatting}"> <strong>${teamBatting}</strong>
        </div>
        <div class="score-line">${data.prediction} Runs</div>
      `;
    } catch (error) {
      console.error("Prediction Error:", error);
      resultElement.textContent = "Error: Could not get prediction!";
    }
  }

  async function predictSecondInnings() {
    if (!teamBatting || !teamBowling) {
      showModal("Please select both batting and bowling teams!");
      return;
    }
    const target = document.getElementById("target").value;
    const curr_runs = document.getElementById("curr_runs2").value;
    const curr_wickets = document.getElementById("curr_wickets2").value;
    const overs = document.getElementById("overs2").value;

    if (!target || !curr_runs || !curr_wickets || !overs) {
        showModal("Please fill in all fields for the second innings!");
        return;
    }

    const resultElement = document.getElementById("chase_result");
    resultElement.innerHTML = `<i class="fas fa-spinner fa-spin fa-2x"></i>`;
    
    try {
      const response = await fetch('/predict_second_innings', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ target, curr_runs, curr_wickets, overs })
      });
      const data = await response.json();
      const team2WinProb = data["Probability of Team 2 Winning"];
      const team1WinProb = 100 - team2WinProb;
      const probableWinner = team2WinProb > team1WinProb ? teamBowling : teamBatting;

      resultElement.innerHTML = `
        <div class="winner-line">
          <img src="${flags[probableWinner]}" alt="${probableWinner}">
          <span class="winner-name">${probableWinner}</span>
        </div>
        <div class="probability-line">
          <span class="team-prob">
            <img src="${flags[teamBatting]}" alt="${teamBatting}">
            <span>${teamBatting}: <strong>${team1WinProb.toFixed(1)}%</strong></span>
          </span>
          <span class="prob-separator">|</span>
          <span class="team-prob">
            <img src="${flags[teamBowling]}" alt="${teamBowling}">
            <span>${teamBowling}: <strong>${team2WinProb.toFixed(1)}%</strong></span>
          </span>
        </div>
      `;
    } catch (error) {
      console.error("Prediction Error:", error);
      resultElement.textContent = "Error: Could not get prediction!";
    }
  }
</script>

</body>
</html>

